# nanopore-demux

## Description
The `nanopore-demux` pipeline is designed for the demultiplexing of nanopore raw data. It processes sequencing data generated by Oxford Nanopore Technologies (ONT) and supports various configurations and modes to handle different types of input data and processing requirements. The pipeline is built using Nextflow, enabling scalable and reproducible workflows.

## Usage

```
nextflow run crick-pipelines-stp/nanopore-demux \
  --samplesheet samplesheet.csv \
  --run_dir RUN_DIR
```

## Parameters

### Input Parameters
- `--run_dir`: Directory containing the raw sequencing data.
- `--samplesheet`: Path to the samplesheet CSV file.
- `--bam`: Path to an existing BAM file (optional).
- `--mode`: Mode of operation, default is 'ont'.

### ONT Dorado Parameters
- `--dorado_model`: Dorado model to use for basecalling, default is "hac".
- `--dorado_bc_kit`: Barcode kit to use for demultiplexing.
- `--dorado_bc_parse_pos`: Position to parse barcodes.
- `--dorado_append_bc`: Append barcode information to output, default is true.
- `--dorado_batch_num`: Number of reads per batch, default is 1000.
- `--dorado_gpu_num`: Number of GPUs to use, default is 2.
- `--dorado_gpu_queue`: GPU queue to use.
- `--dorado_gpu_res`: GPU resources to allocate.
- `--dorado_args`: Additional arguments for Dorado.
- `--dorado_resume_bam`: Path to a BAM file to resume from.

### Filtering Parameters
- `--chopper_split_count`: Number of splits for chopper, default is 4.
- `--min_qscore`: Minimum quality score for filtering, default is 10.

### Output Parameters
- `--output_bam`: Output BAM files as well as FASTQ, default is false.
- `--output_raw`: Output raw unfiltered files, default is false.

## Samplesheet

The samplesheet is a CSV file that contains information about the samples to be processed. Each row represents a sample and must include the following columns.

| Column            | Description                                      |
| `id`              | Unique identifier for the sample                 |
| `sample_name`     | Name of the sample                               |
| `group`           | Group or batch the sample belongs to             |
| `user`            | User who submitted the sample                    |
| `project_id`      | Project identifier                               |
| `barcode`         | Barcode sequence used for the sample             |

### Example Samplesheet

```csv
id,sample_name,group,user,project_id,barcode
SEG7608A2,SSEV009,boultons,sandra.segura-bayona,DN24329,NB04 (AGAGGGTACTATGTGCCTCAGCAC-GTGCTGAGGCACATAGTACCCTCT)
SEG7608A4,SSEV011,boultons,sandra.segura-bayona,DN24329,NB05 (CACAAAGACACCGACAACTTTCTT-AAGAAAGTTGTCGGTGTCTTTGTG)
SEG7608A21,SSEV004,boultons,sandra.segura-bayona,DN24329,NB01 (GTAAGTTGGGTATGCAACGCAATG-CATTGCGTTGCATACCCAACTTAC)
SEG7608A23,SSEV006,boultons,sandra.segura-bayona,DN24329,NB02 (GCTTGCGATTGATGCTTAGTATCA-TGATACTAAGCATCAATCGCAAGC)
SEG7608A24,SSEV007,boultons,sandra.segura-bayona,DN24329,NB03 (ACTGGTGCAGCTTTGAACATCTAG-CTAGATGTTCAAAGCTGCACCAGT)
```
